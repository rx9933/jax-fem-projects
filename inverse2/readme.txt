using adjoint method to find gradients
